---
icon: material/docker
---

# Prison Escape

**Difficulty**: :fontawesome-solid-star::fontawesome-solid-star::fontawesome-solid-star::fontawesome-regular-star::fontawesome-regular-star:<br/>
**Direct link**: [escape terminal](src="https://hhc22-escapeh.kringlecon.com?&challenge=escape&id=f572974d-94e1-474b-89ae-56f99dc6393d")


## Objective

!!! question "Request"
    Escape from a container. Get hints for this challenge from Bow Ninecandle in the Elfen Ring. What hex string appears in the host file `/home/jailer/.ssh/jail.key.priv`?

??? quote "Tinsel Upatree"
    Hiya hiya, I'm Tinsel Upatree!<br/>
    Check me out, I'm working side-by-side with a real-life Flobbit. Epic!<br/>
    Anyway, would ya' mind looking at this terminal with me?<br/>
    It takes a few seconds to start up, but then you're logged into a super secure container environment!<br/>
    Or maybe it isn't so secure? I've heard about container escapes, and it has me a tad worried.<br/>
    Do you think you could test this one for me? I'd appreciate it!


## Hints

??? hint "Over-Permissioned"
    When users are over-privileged, they can often act as root. When containers have too many [permissions](https://learn.snyk.io/lessons/container-runs-in-privileged-mode/kubernetes/), they can affect the host!

??? hint "Mount Up and Ride"
    Were you able to `mount` up? If so, users' `home/` directories can be a great place to look for secrets...

## Solution

??? abstract "Welcome message"
    Greetings Noble Player,<br/>
    You find yourself in a jail with a recently captured Dwarven Elf.<br/>
    He desperately asks your help in escaping for he is on a quest to aid a friend in a search for treasure inside a crypto-mine.<br/>
    If you can help him break free of his containment, he claims you would receive "MUCH GLORY!"<br/>
    Please, do your best to un-contain yourself and find the keys to both of your freedom.

Checking our `sudo` privileges using `sudo -l` we see we can execute anything using `sudo`. So, we run `sudo su` to elevate ourselves into a root shell. As root we can now mount the disk `/dev/vda` to a folder inside the container using:

```bash
mkdir ./tmp
mount /dev/vda tmp
cat /home/samways/tmp/home/jailer/.ssh/jail.key.priv
```

Inside `/home/samways/tmp/home/jailer/.ssh/jail.key.priv` will be a message that we found the secret for the HHC22 container escape challenge: `082bb339ec19de4935867`.

!!! done "Answer"
    `082bb339ec19de4935867`

## Response

!!! quote "Tinsel Upatree"
    Great! Thanks so much for your help!<br/>
    Now that you've helped me with this, I have time to tell you about the deployment tech I've been working on!<br/>
    Continuous Integration/Continuous Deployment pipelines allow developers to iterate and innovate quickly.<br/>
    With this project, once I push a commit, a GitLab runner will automatically deploy the changes to production.<br/>
    WHOOPS! I didnâ€™t mean to commit that to http://gitlab.flag.net.internal/rings-of-powder/wordpress.flag.net.internal.git...<br/>
    Unfortunately, if attackers can get in that pipeline, they can make an awful mess of things!
